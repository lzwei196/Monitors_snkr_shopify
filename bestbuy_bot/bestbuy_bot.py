import requests
import json
import datetime
import time

url = "https://www.bestbuy.ca"
order_url = "https://www.bestbuy.ca/api/checkout/checkout/orders"
#bestbuy restocks at each quater
#the_time = ["14","15","59","0","29","30","44","45","55","56"]
#switch animal crossing 14425777
#ringfit 13961770


class bestbuy:
    def __init__(self):
        self.session = requests.Session()
        lineItems = {}
        while True:
          # currentDT = datetime.datetime.now()
          # minute = str(currentDT.minute)
          # sec = str(currentDT.second)
          # if minute in the_time:
            try:
                lineItems = self.atc()
                #(lineItems)
            except Exception as e:
                #print(e)
                pass
            if lineItems[0]["total"] != 0:
                try:
                    obj = self.submit_shipping(lineItems)
                    id = obj[0]
                    totalPurchasePrice = obj[1]
                    self.submit_payment(id)
                    self.submit_order(id, totalPurchasePrice)
                except Exception as e:
                    pass
                    #print(e)

    def atc(self):
        add_to_cart_url = "https://www.bestbuy.ca/api/basket/v2/baskets"
        data = {"lineItems":[{"sku":"14425777","quantity":1}]}
        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "Content-Length":"47",
            "content-type": "application/json",
            "origin": "https://www.bestbuy.ca",
            "postal-code": "H3K",
            "region-code": "QC",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
           #"x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJmNDZjZjE1Ny04N2Q4LTQwZDMtOGQzNy0yYzA3ZjdhMDM3OGUifQ.0oSnniqudGcnuJa67TB2qI6wyid-erEO6BqRCd0YZfo"
        }
        r = self.session.post(add_to_cart_url, data=json.dumps(data), headers=headers)
        lineItems = json.loads(r.text)["shipments"][0]["lineItems"][0]
        obj ={}
        lineItems_format = []
        obj["lineItemType"]="Product"
        obj["name"]=lineItems["sku"]["product"]["name"]
        obj["offerId"]=lineItems["sku"]["offer"]["id"]
        obj["quantity"]= 1
        obj["sellerId"] = "bbyca"
        obj["sku"] = lineItems["sku"]["id"]
        obj["total"] = json.loads(r.text)["shipments"][0]["totalPrice"]
        lineItems_format.append(obj)
        #print(lineItems_format[0]["total"])
        return  lineItems_format

    def start_checkout(self):
        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "Content-Length": "47",
            "content-type": "application/json",
            "origin": "https://www.bestbuy.ca",
            "postal-code": "H3K",
            "region-code": "QC",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca"}
        r = self.session.get("https://www.bestbuy.ca/checkout/?qit=1#/en-ca/shipping/", headers=headers)
        #print(r.text)
       # print(self.session.cookies.get_dict())

    def submit_shipping(self,lineItems):
        data = {"email":"lzweijinwei196@gmail.com","shippingAddress":{"address":"1450, RENÉ-LÉVESQUE BLVD. WEST, 1510","apartmentNumber":"","city":"montreal","country":"CA","firstName":"ziwei","lastName":"li","phones":[{"ext":"","phone":"4387258504"}],"postalCode":"H3G0E1","province":"QC"}}
        data["lineItems"] = lineItems
        #print(data)
        shipping_headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-Length":"495",
            "content-type": "application/json",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
            'cookie':'clientId=ZB8wTWBSxyCoMdeS; criteoVisitorId=b5fba6ae-f198-4ab2-a7b9-1f6af271c5c9; s_ecid=MCMID%7C39650301569995348542995936665792211602; ai_user=Afnm4|2020-05-04T17:09:29.416Z; _gcl_au=1.1.490441140.1588612170; _ga=GA1.2.1621499856.1588612169; BVBRANDID=53f9bd98-3b3e-4db8-890c-ac55b4c60cec; s_fid=1EEEEBBE64ED914F-002F37E5E612D0DE; CS_Culture=en-CA; gbi_visitorId=ckdk2f7ve00013b88kb2jbaln; __gads=ID=ef24cbad2818d045:T=1600265196:S=ALNI_MZ5LCUbRPG13h2UCwbnUPcPaTdHKQ; _fbp=fb.1.1600265211705.18527153; tia=854427b3306094b7ed13d30fcb43670212ce72abd7c466000e55975162eec4ed; tir=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ7ZGY1ZmUwNTMtOTMxYy00YTNkLTk1YzAtYzViNmU5OTIzOTZlfSJ9.OGbbR-hEwykvTdSJ7UleFWi-p9OmyNacSlzoLZr47Z0; s_ev46=%5B%5B%27knc-s-71700000055259900%27%2C%271599072161632%27%5D%2C%5B%27knc-s-71700000055264715%27%2C%271600544377696%27%5D%5D; _gcl_aw=GCL.1600544379.CjwKCAjw2Jb7BRBHEiwAXTR4jRcXRinCOckp4gvml64wEq3zIlStBp6NUAUzdjgTedRdIBBFguffMBoCe-4QAvD_BwE; _gcl_dc=GCL.1600544379.CjwKCAjw2Jb7BRBHEiwAXTR4jRcXRinCOckp4gvml64wEq3zIlStBp6NUAUzdjgTedRdIBBFguffMBoCe-4QAvD_BwE; _gac_UA-122294325-1=1.1600544379.CjwKCAjw2Jb7BRBHEiwAXTR4jRcXRinCOckp4gvml64wEq3zIlStBp6NUAUzdjgTedRdIBBFguffMBoCe-4QAvD_BwE; IR_PI=7fce2e92-fccf-11ea-9c6d-02f3abf8e806%7C1600864277755; rxVisitor=16023781838001DVVB7AJ9L9ECD8JN0RELIL74JAFT3OT; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; enabled=1; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18547%7CMCMID%7C39650301569995348542995936665792211602%7CMCAAMLH-1602982985%7C7%7CMCAAMB-1602982985%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1602385385s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.3.0%7CMCCIDH%7C120335038; _pin_unauth=dWlkPU5UY3lNMlE1TWpFdE1ETmpOaTAwT1RCakxXSmtaakl0T0RrellXRmlObU5pTVRBNQ; gbi_sessionId=ckg4elmc500003a89cuuhtkqe; check=true; s_lv_s=More%20than%207%20days; s_vnum=1604203200371%26vn%3D1; s_invisit=true; AA_previousTA=; s_cc=true; _gid=GA1.2.841616360.1602378190; BVImplmain_site=18193; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Westmount%22%2c%22postalCode%22%3a%22H3Z%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Westmount%22%2c%22postalCode%22%3a%22H3Z%22%2c%22region%22%3a%22QC%22%7d%7d; fdb7491a5cc3d693edd0926b3a48659f=77067571ea5e3011fef850ce40b83cef; rxVisitor=16023781838001DVVB7AJ9L9ECD8JN0RELIL74JAFT3OT; b6bab32db12a74433294191e1fddb23a=66a399b917466783d51e5daf8697aa11; 47236a0d189c10314faac13e28785259=a614db88a78a008ca1a0efa415f7eab7; QueueITAccepted-SDFrts345E-V3_dryrun12020checkout=EventId%3Ddryrun12020checkout%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1602378858%26Hash%3D9907457b58596d0ff56f6b79819b26be5a7683074614bd562f7cdfba63d2bda6; AA_hasSeenCheckoutThisVisit=true; 3cb77e1367939b2c1a51f46cb3d4be5b=dd8593e311cdfa6b8570e506706ba92e; bm_mi=A0384E39A33FB2BFA442769B53D5F978~eoHjoFSw6MTs+1dOtGy3uWutF9ZSczcZ49oGkXKw31YxR0/5Hx7QyYZNdlhOdlrKAhs9Jtxi7CDIWM9RvxQFdC/6ADu3hWFvGSEgMbaHS2TssAUu98An3FzVKyrDmbIvYWVnkhL5C6qtCN3vGKxNIXfMLSFUpW+sNgqrLN91jnBGv0Yfn/a7F1Ov6JeS0VEt4G0ZxoVioPMpK/I0VkCWtRd/hI1v7FBkH/D4Hfjcu/DQIduFXGHJmMub082TqFxX7NGr+VGKf4sJ92J5cIW+W/bW+T4o+SKuHDixquVZuDo=; ak_bmsc=B6DBF83899F225D632D3AEB4F918674CB89660C505380000F05E825FAFBB5B1F~pll8TjiohU82nf/tJXkkjSmQ3OyEHD0AKQyhcCloe4VzSMS9IACa4DwlFei8C6q3nsUIooF/SIeRRaxn8pVQrT0APKGGvj1s8INFz9cO6XT32HD+2JoMHg7KQRfTuSLPUxRFTCJu2cU8K4OTd0JErx886+dPKd71LPuzuCAj1qVIAfzVe24JBelXP7uaaFptLa9S9JQgueK1G87SdHBYuk7D1ScBz/qKWnDXICv6EmdvrH6J3M6Uq3QRLUY6sWj+Dr; ai_session=E8z4WO3WaGIpFExvk6G77x|1602378185524|1602380218321; QueueITAccepted-SDFrts345E-V3_dryrun12020browse=EventId%3Ddryrun12020browse%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Ddisabled%26IssueTime%3D1602380216%26Hash%3Dd627a2eb8349c558f20b6524992fa9ab21b62f43c5bd594de7c5dd4f567ba96f; dtm_mSession=72c7ad1c06464d0fa35174036078e0aa; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1602380220,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1620148169}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1602380222710%7C380215615_50%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1602379348465%7C%7C; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJmMTQwZGE3YS04M2QxLTRkNWItYmM5OS0xNTQ4NzBjMzdkNTQifQ.GtQKRT1BaS358ioWkqwApav5MVJgjmAqJdDFB28r8kE; cid=%7B%22email%22%3A%22lzweijinwei196%40gmail.com%22%2C%22id%22%3A%22%7Bdf5fe053-931c-4a3d-95c0-c5b6e992396e%7D%22%2C%22firstName%22%3A%22ziwei%22%2C%22authenticationState%22%3A%22RECOGNIZED%22%7D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1602380215177%7C379376773_958%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1602379379982%7C%2Fen-ca%2Fpayment%7C; _derived_epik=dj0yJnU9VDVpbk5UZ09IZVIzeXdQZDBnU1k0SFkxaEJNdVh6XzUmbj1OR0FUbzhTTWQzRDBYRmZERU5YSlVRJm09MSZ0PUFBQUFBRi1DWWNBJnJtPTEmcnQ9QUFBQUFGLUNZY0E; mbox=PC#bf89a21c90194803bd076d12027b2ad0.17_0#1665625029|session#72c7ad1c06464d0fa35174036078e0aa#1602382078; AA_pagePathingCount=26; s_lv=1602380228999; s_getNewRepeat=1602380229005-Repeat; AA_previousCategory=dth%20checkout; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousPageType=; s_sq=%5B%5BB%5D%5D; bm_sv=6E8013A8946837A6B9A3922CE0CF6F53~+HYHnZq5x9uNQnFzXoZgxc9NuwJKXQDbEZYUUpC2VYd8XTHFp7sZf+wmbc0UeGztKAS0GBYEkA1/sjkicgzHpg09T8r9yJA18a1SywE2g7K8AKPi48nPMiCncT/hTvkWXNb3w5UqR7HspW+Fmh1Yu98waIGvFVPc9xgBo2PQzRQ=; cartId=2d4a2294-1b49-489b-8f76-9c396f856ac8; dtCookie=1$FF0B1A7824AB8FAF8B56BF3E713CE0CD|ea7c4b59f27d43eb|0; dtLatC=2; dtPC=1$380225467_352h8vPWMFGFRQGNRGOKHUIUMLIJMRMELMMQHC-0e14; rxvt=1602382031128|1602378183806',
            "referer": "https://www.bestbuy.ca/checkout/?qit=1",
            "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJmMTQwZGE3YS04M2QxLTRkNWItYmM5OS0xNTQ4NzBjMzdkNTQifQ.GtQKRT1BaS358ioWkqwApav5MVJgjmAqJdDFB28r8kE",
            #'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
        }
        try:
            r = self.session.post(order_url,headers=shipping_headers,json=data)
            print(r.text)
            id = json.loads(r.text)["id"]
            totalPurchasePrice = json.loads(r.text)["totalPurchasePrice"]
        except Exception as e:
            print(e)
        return [id,totalPurchasePrice]

    def submit_payment(self,id):
        url = "https://www.bestbuy.ca/api/checkout/checkout/orders/"+id+"/payments"
        data = {"email":"lzweijinwei196@gmail.com","payment":{"creditCard":{"billingAddress":{"address":"1450, RENÉ-LÉVESQUE BLVD. WEST, 1510","apartmentNumber":"","city":"montreal","country":"CA","firstName":"ziwei","lastName":"li","phones":[{"ext":"","phone":"4387258504"}],"postalCode":"H3G0E1","province":"QC"},"cardNumber":"iMJ1YnmfHLzxDXGKIAq71AfB7irftLZQFcb4D7QAQ2/SGz7c8ej3msvUeef08nyrh+C2YTVVf3FxDk8y56ccLLnuJbGS5Mn3njawy5Rr8+UgoRZ/WliDXLOlOWbSK7ZvOmyIDzQu81JhJl8UC2b5c62lDx07ELrgZ4dOScbRTwsXR6pvQCn6GkvJPSIYrY+Y7ThRAUNUBlAWsP0MPRKzBWq5tyx6gahZnJZcChUnsKSawr3YtRLKZFAlFsmAr4yw/JSYI93XcRXE0Jl2WLE1xd+y543cy1N5vEfrTbbVohThQqvCXuYUzaHs0q98DIp3uFmDkXQ+4blpCyDma+TEbA==6631","cardType":"VISA","cvv":"187","expirationMonth":"3","expirationYear":"2023"}}}
        headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-Length": "744",
            "content-type": "application/json",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
           # "cookie": "cookie: rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={\"currentUrlPath\":\"/en-ca/basket\",\"hasSurveyBeenDisplayed\":false,\"heartBeat\":1586292708,\"isInSampling\":false,\"pageViewCount\":4,\"surveyLastDisplayed\":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJiZTNkNGJlNi05MTlhLTQzYzAtYmQzYy1jMzBlNzcwOWI2NDAifQ.-CZjY90famiPhuWwCaRXE-notOWw6r0ZlG467JKDrmc; 3cb77e1367939b2c1a51f46cb3d4be5b=b29482b9b8508d5b13a1e75da3a0a12a; bm_mi=06E6CA2C944AA5733D908CD6708FAB0B~TYgdNNEKNVz0pmfBajxhnz85D+nGcz1ekJXwpuM+8Wxiz8tqC8GlLYoAChzTQ/nEZ1oAjwg3XdHUHjoHI3QK4CqqRw808XIVEfr5JLvzCqywlkxXjIrGg9xAOGs133/kQRFKmt/URdGIUigRCZp9mSiCmyWR7Bnm3OTMKBoBHqo5ZyboCeHNy/YUegVjcMB3yp0a9lI3U9mzCDoqoUBGIvSY+9+60pClL6FNN8S6/eY=; bm_sv=F6CF3667E0E5AB7AB2F275BC98955B54~UKUpNtMqQhOlBJ7pWmPxrWgFw55SVdv+cOJGFTZFXbPX3vf96jFidYrYxjIqYci9YMVia6As0XIx4qmPzZhljYZ5g64oUFJkN2wGpNefVgpdMTpbJbVObVaBS9PTnvBD29H03WenUjc1+fG2fQ+ExCUcCNm86Erd86MGLj07ZDg=; ak_bmsc=F9C619C16FB4730BCB3470940107336BB896608710130000DBC4985E0088A70E~pl0nPtMNLkqyCxF75i45OJ+EqhxKYCBzVRkH7X9RlM4W4d7wKz9vq1P9bNL0t3hFxDHlxT6UAOnuLT+njUzwe7ku47hT1KFQUB0X2hIRYpCaVzCiEaJfUn4M6ZqttjhIfgxC3ydrB481xlgqAOaVAoK35deBAPjN3ndrMEPoJY2AOBhPU1nyAZ7Om6Q8EiLyBa1qmOqzmaAFyMa4t+UEmLuU2VtLOBNg91cHwkpTLEWy1gp65xJfxlPnTOi8drB8KD",
            "referer": "https://www.bestbuy.ca/checkout/?qit=1",
            "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f',
            'x-dtpc': '1$380225467_352h8vPWMFGFRQGNRGOKHUIUMLIJMRMELMMQHC-0e14'
        }
        r = self.session.put(url,headers=headers,json=data)
        #print(r.text)

    def submit_order(self,id,totalPurchasePrice):
        url = "https://www.bestbuy.ca/api/checkout/checkout/orders/submit"
        headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-Length": "5665",
            "content-type": "application/json",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
           # "cookie": "cookie: rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={\"currentUrlPath\":\"/en-ca/basket\",\"hasSurveyBeenDisplayed\":false,\"heartBeat\":1586292708,\"isInSampling\":false,\"pageViewCount\":4,\"surveyLastDisplayed\":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJiZTNkNGJlNi05MTlhLTQzYzAtYmQzYy1jMzBlNzcwOWI2NDAifQ.-CZjY90famiPhuWwCaRXE-notOWw6r0ZlG467JKDrmc; 3cb77e1367939b2c1a51f46cb3d4be5b=b29482b9b8508d5b13a1e75da3a0a12a; bm_mi=06E6CA2C944AA5733D908CD6708FAB0B~TYgdNNEKNVz0pmfBajxhnz85D+nGcz1ekJXwpuM+8Wxiz8tqC8GlLYoAChzTQ/nEZ1oAjwg3XdHUHjoHI3QK4CqqRw808XIVEfr5JLvzCqywlkxXjIrGg9xAOGs133/kQRFKmt/URdGIUigRCZp9mSiCmyWR7Bnm3OTMKBoBHqo5ZyboCeHNy/YUegVjcMB3yp0a9lI3U9mzCDoqoUBGIvSY+9+60pClL6FNN8S6/eY=; bm_sv=F6CF3667E0E5AB7AB2F275BC98955B54~UKUpNtMqQhOlBJ7pWmPxrWgFw55SVdv+cOJGFTZFXbPX3vf96jFidYrYxjIqYci9YMVia6As0XIx4qmPzZhljYZ5g64oUFJkN2wGpNefVgpdMTpbJbVObVaBS9PTnvBD29H03WenUjc1+fG2fQ+ExCUcCNm86Erd86MGLj07ZDg=; ak_bmsc=F9C619C16FB4730BCB3470940107336BB896608710130000DBC4985E0088A70E~pl0nPtMNLkqyCxF75i45OJ+EqhxKYCBzVRkH7X9RlM4W4d7wKz9vq1P9bNL0t3hFxDHlxT6UAOnuLT+njUzwe7ku47hT1KFQUB0X2hIRYpCaVzCiEaJfUn4M6ZqttjhIfgxC3ydrB481xlgqAOaVAoK35deBAPjN3ndrMEPoJY2AOBhPU1nyAZ7Om6Q8EiLyBa1qmOqzmaAFyMa4t+UEmLuU2VtLOBNg91cHwkpTLEWy1gp65xJfxlPnTOi8drB8KD",
            "referer": "https://www.bestbuy.ca/checkout/?qit=1",
            "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
        }
        data = {"cvv":"185","email":"lzweijinwei196@gmail.com","secureAuthenticationResponse":"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"}
        data["totalPurchasePrice"] = totalPurchasePrice
        data["id"] = id
        r = self.session.post(url, headers=headers,json=data)
        print(r.text)

while True:
    try:
        bestbuy = bestbuy()
    except Exception as e:
        pass
