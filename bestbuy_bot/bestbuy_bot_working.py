import requests
import json
import datetime
import time
from shopifyMonitor import load_proxy, parse_proxy
import random

########################### General param ##########################
####REPLACE the address, credit card info in the submit shipping, payment and order section
#the cookie will be expired in an hour, haven't tested much, but this seems to be the case
#xtx is has to match
#the easiest way maybe go to the site and go through the whole atc and submit order process and manually grab all the information
#currently You should be getting res from each step, if not, change the cookie

url = "https://www.bestbuy.ca"
order_url = "https://www.bestbuy.ca/api/checkout/checkout/orders"
#bestbuy restocks at each quater
the_time = ["14","15","59","0","29","30","44","45","55","56"]
sku = "14962184"
cookie = 'clientId=LKW79mCc6IWh15uj; criteoVisitorId=4373ca22-d8b3-47e3-b95d-b4efdab250c0; s_ecid=MCMID%7C53412406115792407981988834282011167775; ai_user=uT/Y1|2020-09-26T22:45:19.755Z; gbi_visitorId=ckfk9iise00013b7zja1w2wem; BVBRANDID=d43954e6-773b-4a20-949b-f535ebc0fd37; _gcl_au=1.1.2052194769.1601160325; _ga=GA1.2.1267216390.1601160320; _pin_unauth=dWlkPU56SmpNVFppWWpZdE9XVTFNQzAwT0dReUxUbG1ZV1F0TWpZNE5tRmpaRGczTWpSbA; _gcl_dc=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gcl_aw=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gac_UA-122294325-1=1.1603645941.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; s_ev46=%5B%5B%27knc-s-71700000055465044%27%2C%271601160324957%27%5D%2C%5B%27knc-s-71700000071852306%27%2C%271601519284827%27%5D%2C%5B%27knc-s-71700000065731896%27%2C%271601519312498%27%5D%2C%5B%27knc-s-71700000072655674%27%2C%271603645941045%27%5D%5D; CS_Culture=en-CA; GB_test=solr; s_fid=12BA2000AEFDC1E7-3D85D9B9C06A51E5; _gid=GA1.2.1278153862.1605034031; tia=854427b3306094b7ed13d30fcb43670212ce72abd7c466000e55975162eec4ed; _abck=28933C4392D2789987959A7CC76DB958~0~YAAQrWCWuARd1rB1AQAAJ+B7swT9drZJdtcc9XmAKxML10I/vCV3Sz1zGjCLqHT6sEdMC7Yvhzf+i/T2eHD72eZmawa2dFSPTe3IvWZEzUKD+JTKAOfmK0ZZlU+lTIbvjNl05rQie/7G8q+o6ijvi7XBvBCMMEDy9xx+pDrV91604VhBAqZDu5icQ4+3iH4dLMVPfc7qi8mL/ot7yBwANuTUOHEAEgwY/TyqKZ1tIBNKpo8czGXP5yd6Grj5kPwewlNo3znj8N/Ed+JK8xxKqcH/rM2NsZyqY7ATYTzUYFMMLX9FjX0yEy7iMxQo7RO8H7Mla3o7gA==~-1~-1~-1; bm_sz=B7709E9F81D3A6A68276B787DE8C6D40~YAAQtWCWuK9er7R1AQAAx4tCuAmEhYilMaR6Wgf0ROmfsH4lERufW3FGugeo6MY2uB8C9d3Pq6PJqm5WlWEbhuUb+UT2xUgYhnUNAJg6OIukVpMqhL42mR9ptfPU6agz/ToFMKjKNhZm+TXLvgu25ShVjMsW8ybOQBb85rfrSPjWOH7VpDp2lJL2YulQVvro; bm_mi=463AC3E43B27848F99FD48AE2B98D63E~BTxtgLICaT6Z51fSJ8Zle079OlGt8yKEZum3o/npC/4/DHcT+QvBYn9MuM1HxvirF6jafTIY7CB4BgmLm/gLDBX3XBozI6WzotX9ar9h2D/tE9Wb9aryt0tsiqyUUhQCTdZu+VtRY2Q15T7UHDz4ofb8Ah8ueownYqO9AF0OC1Cz7VbCMOogjAaxdu2xx6hu5+oxSuxZqC2B1DunZiJCMdLAR2p0S/76j+k9g4Y4VtBRJB/g6DQ5+m7tfPcBMIjcrLtUcguE6a+rLhuCddECZg==; rxVisitor=1605114170488UO7V00M5LE3QTL4HS8LDC9DKNP2D2UEM; enabled=1; surveyOptOut=1; ReturnUrl=https://www.bestbuy.ca/; ak_bmsc=E220EFF8B901ADBB346DB50A75A260C9B89660B5216200003A19AC5FF819BA1E~plXSz9qSe+L/jSOFMevYVV7v3Mwleugwl4bUTxC6PxKvyPaDfyDJdY3yo7im4ODxy3Po19cr/Gn4qeRAJF27vIMz5E7975/ScgXlz3czdtK7yqQYe9+aQDGWAbpYRjh3y4rnsbnBh+LCa7gQ+4rYUKXXYDifO/2A4MAMItKaU9CTexz+UT/RgCJ/1PCWBtmhMo+rySblzqOhGa5alDKquMGZljZaB7ZCxIPbzRkwaYh9Qg81M8deccelAoydrSq+gG; check=true; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18577%7CMCMID%7C53412406115792407981988834282011167775%7CMCAAMLH-1605718973%7C7%7CMCAAMB-1605718973%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1605121373s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.3.0%7CMCCIDH%7C120335038; s_cc=true; BVImplmain_site=18193; ai_session=dBGLVjO4SSCw58kGOWKxEi|1605117811197|1605117811197; gbi_sessionId=ckhdppa4100003b8bcczp3fm8; dtm_mSession=5c4df32cbc32458380f9ac3499f1a800; _gat_gtag_UA_122294325_1=1; s_lv_s=Less%20than%201%20day; s_vnum=1606798800114%26vn%3D10; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_dryrun4b2020browse=EventId%3Ddryrun4b2020browse%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Ddisabled%26IssueTime%3D1605117812%26Hash%3Da50f0222235b90458ab1c3d5417f00bd68f2e9abd828d6b4c4c79b0c26ea18b2; fdb7491a5cc3d693edd0926b3a48659f=18600aedf7bbae8b39bcef9247311aea; cid=%7B%22email%22%3A%22lzweijinwei196%40gmail.com%22%2C%22id%22%3A%22%7Bdf5fe053-931c-4a3d-95c0-c5b6e992396e%7D%22%2C%22firstName%22%3A%22ziwei%22%2C%22authenticationState%22%3A%22UNAUTHENTICATED%22%7D; BVBRANDSID=9b0b7583-5ad1-49ce-9c3e-29bc02d41a3a; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3G%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3G%22%2c%22region%22%3a%22QC%22%7d%7d; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1605117830,"isInSampling":false,"pageViewCount":12,"surveyLastDisplayed":1632696319}; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1605117831275%7C117809882_674%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1605117813857%7C%7C; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI3MTg5NjFlNC04N2ZkLTQ3OGMtOWVmNS01MjcwYjhjZjEyOTAifQ.Ju6mHafUmGqfW593LcTpxI9PtXkOBBh_7PCeJ32_vao; rxVisitor=1605114170488UO7V00M5LE3QTL4HS8LDC9DKNP2D2UEM; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1605117831275%7C117809882_674%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1605117813857%7C%7C; _derived_epik=dj0yJnU9YVQzZi1NNEdxUzRKTUF1V2s0dUZKVzI2ckF2clZBcTYmbj1KWFhtNEdyY2xibDIwbUp4cHJydzhRJm09NyZ0PUFBQUFBRi1zSjRv; QueueITAccepted-SDFrts345E-V3_dryrun42020checkout=EventId%3Ddryrun42020checkout%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Ddisabled%26IssueTime%3D1605117834%26Hash%3Dd86224a789c03b8ddabc00f01c79aab80fd932ea6519ee26a13976740d800d04; 47236a0d189c10314faac13e28785259=b5baf2e9de9ed8ffcbaca1de917063b7; dtPC=1$117833106_118h-vEARBPCFOPBRERHAIPCBCPSJCQKMDAQDB-0e7; dtCookie=1$3LQ54P4CILH2LD34CM7Q44MK5CD30MQ9|ea7c4b59f27d43eb|0; rxvt=1605119636153|1605117809888; mbox=PC#13bed9d3bb2045d09a3a04d09dfb9d86.35_0#1668362637|session#5c4df32cbc32458380f9ac3499f1a800#1605119671; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=5; s_lv=1605117836181; s_getNewRepeat=1605117836184-Repeat; AA_previousCategory=dth%20checkout; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousPageType=; s_sq=%5B%5BB%5D%5D; bm_sv=D5B45243212A384A587D4279EB50C55C~6HZzzw7IFbInk+AObMlhLCjWjMlA7jzWCaH/70Lswss3xDqWR5w67fFXFJFsPof62AigbsyWLqlgy9R4UKwXIASnhdn0/pI0JpbAily6YxbnAsgpoQ0XCOulMs+mvAq5LRCFH3P7Q8mvGRj4dcJm75jM7mhNYUib0RXU+j+oK5c=; dtLatC=1; b6bab32db12a74433294191e1fddb23a=a830c713609836df4de07e88cf059364; dtCookie=1$3LQ54P4CILH2LD34CM7Q44MK5CD30MQ9|ea7c4b59f27d43eb|0; cartId=f6d0e89f-e10c-43cf-8011-0034263f5073; dtLatC=3; dtPC=1$117833106_118h8vEARBPCFOPBRERHAIPCBCPSJCQKMDAQDB-0e7; rxvt=1605119641692|1605117809888'
xtx = 'eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI3MTg5NjFlNC04N2ZkLTQ3OGMtOWVmNS01MjcwYjhjZjEyOTAifQ.Ju6mHafUmGqfW593LcTpxI9PtXkOBBh_7PCeJ32_vao'
####################################################################



class bestbuy:
    def __init__(self,proxy, proxyornot=True, oneonly = True):
        self.oneonly = oneonly
        self.proxy = proxy
        self.session = requests.Session()
        self.proxyornot = proxyornot
        lineItems = {}

        while True:
          # currentDT = datetime.datetime.now()
          # minute = str(currentDT.minute)
          # sec = str(currentDT.second)
          # if minute in the_time:
            try:
                lineItems = self.atc()
            except Exception as e:
                print(e)
                pass
            if lineItems[0]["total"] != 0 :
                try:
                    obj = self.submit_shipping(lineItems)
                    id = obj[0]
                    totalPurchasePrice = obj[1]
                    self.submit_payment(id)
                    if self.submit_order(id, totalPurchasePrice) and self.oneonly:
                        break
                    else:
                        pass
                except Exception as e:
                   print(e)
                   pass
            sleep = random.randint(1, 10)
            print(f"sleep {sleep}")
            time.sleep(sleep)

    def atc(self):
        add_to_cart_url = "https://www.bestbuy.ca/api/basket/v2/baskets"
        data = {"lineItems":[{"sku":"","quantity":1}]}
        data["lineItems"][0]["sku"] = sku
        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "Content-Length":"47",
            "content-type": "application/json",
            "origin": "https://www.bestbuy.ca",
            "postal-code": "H3G",
            "region-code": "QC",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
           #"x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJmNDZjZjE1Ny04N2Q4LTQwZDMtOGQzNy0yYzA3ZjdhMDM3OGUifQ.0oSnniqudGcnuJa67TB2qI6wyid-erEO6BqRCd0YZfo"
        }
        if self.proxyornot:
            r = self.session.post(add_to_cart_url, data=json.dumps(data), headers=headers, proxies=self.proxy)
        else:
            r = self.session.post(add_to_cart_url, data=json.dumps(data), headers=headers)
        print('############')
        print('adding' + sku + ' to cart')
        #print(r.text)
        lineItems = json.loads(r.text)["shipments"][0]["lineItems"][0]
        obj ={}
        lineItems_format = []
        obj["lineItemType"]="Product"
        obj["name"]=lineItems["sku"]["product"]["name"]
        obj["offerId"]=lineItems["sku"]["offer"]["id"]
        obj["quantity"]= 1
        obj["sellerId"] = "bbyca"
        obj["sku"] = lineItems["sku"]["id"]
        obj["total"] = json.loads(r.text)["shipments"][0]["totalPrice"]
        lineItems_format.append(obj)
        #print(lineItems_format[0]["total"])
        return  lineItems_format

    def start_checkout(self):
        headers = {
            "accept": "*/*",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "Content-Length": "47",
            "content-type": "application/json",
            "origin": "https://www.bestbuy.ca",
            "postal-code": "H3K",
            "region-code": "QC",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca"}
        r = self.session.get("https://www.bestbuy.ca/checkout/?qit=1#/en-ca/shipping/", headers=headers)
        print(r.text)
        print(self.session.cookies.get_dict())

    def submit_shipping(self,lineItems):
        data = {"email":"lzweijinwei196@gmail.com","shippingAddress":{"address":"1450, RENÉ-LÉVESQUE BLVD. WEST, 1510","apartmentNumber":"","city":"montreal","country":"CA","firstName":"ziwei","lastName":"li","phones":[{"ext":"","phone":"4387258504"}],"postalCode":"H3G0E1","province":"QC"}}
        data["lineItems"] = lineItems
        print(data)
        shipping_headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-type": "application/json",
            "content-length":"493",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
            #"cookie":"clientId=LKW79mCc6IWh15uj; criteoVisitorId=4373ca22-d8b3-47e3-b95d-b4efdab250c0; s_ecid=MCMID%7C53412406115792407981988834282011167775; ai_user=uT/Y1|2020-09-26T22:45:19.755Z; gbi_visitorId=ckfk9iise00013b7zja1w2wem; BVBRANDID=d43954e6-773b-4a20-949b-f535ebc0fd37; _gcl_au=1.1.2052194769.1601160325; _ga=GA1.2.1267216390.1601160320; _pin_unauth=dWlkPU56SmpNVFppWWpZdE9XVTFNQzAwT0dReUxUbG1ZV1F0TWpZNE5tRmpaRGczTWpSbA; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; _gcl_dc=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gcl_aw=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gac_UA-122294325-1=1.1603645941.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; s_ev46=%5B%5B%27knc-s-71700000055465044%27%2C%271601160324957%27%5D%2C%5B%27knc-s-71700000071852306%27%2C%271601519284827%27%5D%2C%5B%27knc-s-71700000065731896%27%2C%271601519312498%27%5D%2C%5B%27knc-s-71700000072655674%27%2C%271603645941045%27%5D%5D; s_cc=true; check=true; bm_mi=C956D62C091E3B40E4B5927D3A8DD920~JPJusPStPfy5PCCzkfSsDfJTuY1ZQD2CYfeGGfMfa6dzkm2d2/OKq3shWK0EO/lrSKz7kfz9oDrk6F9u4q5c6MPwiq/UPUCoatMpaOvmKUQ8xX9pyt1yovrVnzcNoLcwBeK7uGOSG8XzTvQHIDzfrinCpbyLYY8v2HZlTPv25/3KGLJi/MrWSubrd8XLi8+5k9jonRxk5j2nFsh5yMiUPQV+tgG1U/AlD7dhAcobUGN5X4O0xXGM1DniFGxLqNUvLqFVaiu/e6pbTHZjMe08lA==; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18564%7CMCMID%7C53412406115792407981988834282011167775%7CMCAAMLH-1604493789%7C7%7CMCAAMB-1604493789%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1603896189s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.3.0; ak_bmsc=F34B7C2D9E147F098073E80747FC6015B8966096790B00005D67995FFBB0C02E~plMBCWiDzGCSS47CMkDeDnpY67JcTD2GF0LJlEZHeiTSBABsFHo3L72946pZ3tRj9V/lxuPW++si4jUwfdGXGL/NYTcsa9lEhjLlCCd1bxH0AxYOrHxadHxFgOGL3FgAU9j24t3Zt6OuNLTaPPS0UxF5TMwQWOImql1gwHsf+5VtHdh3G2+HH9LbDn+QwH/jmKurqM3D8HN5AZY1VXEhiEu+f+oL2ers7xddlG7FQ4cEM9PWjDnxyx5JQpIxNNxeYs; _gid=GA1.2.976140257.1603888991; BVImplmain_site=18193; dtm_mSession=2b130163769f496bb9c49df67a16bf01; _gat_gtag_UA_122294325_1=1; gbi_sessionId=ckgti9g1800013b85xace2yjy; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%7d; dtLatC=1; s_lv_s=Less%20than%201%20day; s_vnum=1604203200574%26vn%3D6; s_invisit=true; AA_previousTA=; nps={'currentUrlPath':'/en-ca/basket','hasSurveyBeenDisplayed':false,'heartBeat':'1603896001','isInSampling':false,'pageViewCount':4,'surveyLastDisplayed':1632696319}; dtPC=1$93165733_79h-vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIwNGU4MzE0MS01MjJlLTQ2NjUtYTMwNS0zNGM3MzBjYTcwZjAifQ.Iz0mUoe9n4hLz3EFYJPQ1BghcSjyX8sHuRRZ2Al7-z0; fdb7491a5cc3d693edd0926b3a48659f=4e9d755d4d178d67f3fc84c07bfb8d97; rxvt=1603897803305|1603894974879; AA_previousPageType=; s_sq=%5B%5BB%5D%5D; ai_session=iC0k5E2oH0EM1bwdu4DUwA|1603895992147|1603896007100.675; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; b6bab32db12a74433294191e1fddb23a=33757115b51b0d3d8d213f0b5d5a4387; _derived_epik=dj0yJnU9b2VzdVo1NXBMdzVfRlBJVmRCN3dNekZNOGtKU092UDYmbj1LVnV6NHZHZnlZQnJhcXBxWm9uVXhBJm09NyZ0PUFBQUFBRi1aZ3Nn; 47236a0d189c10314faac13e28785259=bcded287772b27ed93b0f868a1c2112d; mbox=PC#13bed9d3bb2045d09a3a04d09dfb9d86.35_0#1667140811|session#2b130163769f496bb9c49df67a16bf01#1603897862; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=4; s_lv=1603896010667; s_getNewRepeat=1603896010669-Repeat; AA_previousCategory=dth%20checkout; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; bm_sv=2881C9ACC42CB051F085EFE2AD0222F3~zfYBPcGgFXyP2f8Cv3uc0sQwJ6foKHqgmglm/5ILd9aYW5mJqhuYamGL438tG2MENEDwTrWfEuZRYXPH/od6nroEibLnQNyDd4ClGQNpzLPj52nGuVO0NzTo6NCTYCwdCVAjoLA4Uo+5DGt1irhR7pxTZhGMHrFmuNDM7T9sGfY=; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; cartId=f95041c8-98d0-4cb3-b554-7ff2b600990a; dtLatC=4; dtPC=1$96007592_194h8vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; rxvt=1603897814184|1603894974879",
            "referer": "https://www.bestbuy.ca/checkout/",
            #"x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            "x-dtreferer": "https://www.bestbuy.ca/checkout/#/en-ca/shipping/QC/H3G0E1",
            'cookie':cookie,
            #"x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            #'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            #'cookie':'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            "x-tx":xtx
        }
        if self.proxyornot:
            r = self.session.post(order_url, headers=shipping_headers, json=data, proxies=self.proxy)
        else:
            r = self.session.post(order_url,headers=shipping_headers,json=data)
        print("#######################")
        print('submit shipping')
        print(r.text)
        id = json.loads(r.text)["id"]
        totalPurchasePrice = json.loads(r.text)["totalPurchasePrice"]
        return [id, totalPurchasePrice]

    def submit_payment(self,id):
        url = "https://www.bestbuy.ca/api/checkout/checkout/orders/"+id+"/payments"
        data = {"email":"lzweijinwei196@gmail.com","payment":{"creditCard":{"billingAddress":{"address":"1450, RENÉ-LÉVESQUE BLVD. WEST, 1510","apartmentNumber":"","city":"montreal","country":"CA","email":"lzweijinwei196@gmail.com","firstName":"ziwei","lastName":"li","phones":[{"ext":"","phone":"4387258504"}],"postalCode":"H3G0E1","province":"QC"},"cardNumber":"FaWyaCoECrrrkQz4I3O+M4NM+MnNjaa0qywcTR309KfKB1CNbuCpuQOHdd4pjzcvA9LsxStLWMfNTTqoXcXeiO4HLVXXqumXUEEIMXQoSBqj1vDHfaqJKCv1DrF/IU3jJXRQpzfl+TiuIah04LWzeuyohWg4ig2sKY7SyAQi22dFxiiyK71eKYcI0Xp9AOBx1Vrra4SQEjGCCH4PlkCYPsn9LdLR2uJrnRZdx7p5YgK9fXMTndfsmUdLqgCcdhM6hl6A6BjZIhJDd/WzyuiN/1SJy9eQF5KBnSg2s3oNQUxTd/KrXYkv/25ezf2EK4hOu7ds5BVZjgP2VPUHhNQnDg==6631","cardType":"VISA","cvv":"187","expirationMonth":"3","expirationYear":"2023"}}}
        # headers = {
        #     "accept": "application/vnd.bestbuy.checkout+json",
        #     "accept-encoding": "gzip, deflate, br",
        #     "accept-language": "en-CA",
        #     "content-Length": "779",
        #     "content-type": "application/json",
        #     "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
        #     "Host": "www.bestbuy.ca",
        #     'cookie':'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f',
        #     "referer": "https://www.bestbuy.ca/checkout/",
        #     "x-dtreferer": "https://www.bestbuy.ca/checkout/#/en-ca/payment",
        #     "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
        #     #'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
        # }
        headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-type": "application/json",
            "content-length": "493",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
            # "cookie":"clientId=LKW79mCc6IWh15uj; criteoVisitorId=4373ca22-d8b3-47e3-b95d-b4efdab250c0; s_ecid=MCMID%7C53412406115792407981988834282011167775; ai_user=uT/Y1|2020-09-26T22:45:19.755Z; gbi_visitorId=ckfk9iise00013b7zja1w2wem; BVBRANDID=d43954e6-773b-4a20-949b-f535ebc0fd37; _gcl_au=1.1.2052194769.1601160325; _ga=GA1.2.1267216390.1601160320; _pin_unauth=dWlkPU56SmpNVFppWWpZdE9XVTFNQzAwT0dReUxUbG1ZV1F0TWpZNE5tRmpaRGczTWpSbA; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; _gcl_dc=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gcl_aw=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gac_UA-122294325-1=1.1603645941.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; s_ev46=%5B%5B%27knc-s-71700000055465044%27%2C%271601160324957%27%5D%2C%5B%27knc-s-71700000071852306%27%2C%271601519284827%27%5D%2C%5B%27knc-s-71700000065731896%27%2C%271601519312498%27%5D%2C%5B%27knc-s-71700000072655674%27%2C%271603645941045%27%5D%5D; s_cc=true; check=true; bm_mi=C956D62C091E3B40E4B5927D3A8DD920~JPJusPStPfy5PCCzkfSsDfJTuY1ZQD2CYfeGGfMfa6dzkm2d2/OKq3shWK0EO/lrSKz7kfz9oDrk6F9u4q5c6MPwiq/UPUCoatMpaOvmKUQ8xX9pyt1yovrVnzcNoLcwBeK7uGOSG8XzTvQHIDzfrinCpbyLYY8v2HZlTPv25/3KGLJi/MrWSubrd8XLi8+5k9jonRxk5j2nFsh5yMiUPQV+tgG1U/AlD7dhAcobUGN5X4O0xXGM1DniFGxLqNUvLqFVaiu/e6pbTHZjMe08lA==; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18564%7CMCMID%7C53412406115792407981988834282011167775%7CMCAAMLH-1604493789%7C7%7CMCAAMB-1604493789%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1603896189s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.3.0; ak_bmsc=F34B7C2D9E147F098073E80747FC6015B8966096790B00005D67995FFBB0C02E~plMBCWiDzGCSS47CMkDeDnpY67JcTD2GF0LJlEZHeiTSBABsFHo3L72946pZ3tRj9V/lxuPW++si4jUwfdGXGL/NYTcsa9lEhjLlCCd1bxH0AxYOrHxadHxFgOGL3FgAU9j24t3Zt6OuNLTaPPS0UxF5TMwQWOImql1gwHsf+5VtHdh3G2+HH9LbDn+QwH/jmKurqM3D8HN5AZY1VXEhiEu+f+oL2ers7xddlG7FQ4cEM9PWjDnxyx5JQpIxNNxeYs; _gid=GA1.2.976140257.1603888991; BVImplmain_site=18193; dtm_mSession=2b130163769f496bb9c49df67a16bf01; _gat_gtag_UA_122294325_1=1; gbi_sessionId=ckgti9g1800013b85xace2yjy; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%7d; dtLatC=1; s_lv_s=Less%20than%201%20day; s_vnum=1604203200574%26vn%3D6; s_invisit=true; AA_previousTA=; nps={'currentUrlPath':'/en-ca/basket','hasSurveyBeenDisplayed':false,'heartBeat':'1603896001','isInSampling':false,'pageViewCount':4,'surveyLastDisplayed':1632696319}; dtPC=1$93165733_79h-vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIwNGU4MzE0MS01MjJlLTQ2NjUtYTMwNS0zNGM3MzBjYTcwZjAifQ.Iz0mUoe9n4hLz3EFYJPQ1BghcSjyX8sHuRRZ2Al7-z0; fdb7491a5cc3d693edd0926b3a48659f=4e9d755d4d178d67f3fc84c07bfb8d97; rxvt=1603897803305|1603894974879; AA_previousPageType=; s_sq=%5B%5BB%5D%5D; ai_session=iC0k5E2oH0EM1bwdu4DUwA|1603895992147|1603896007100.675; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; b6bab32db12a74433294191e1fddb23a=33757115b51b0d3d8d213f0b5d5a4387; _derived_epik=dj0yJnU9b2VzdVo1NXBMdzVfRlBJVmRCN3dNekZNOGtKU092UDYmbj1LVnV6NHZHZnlZQnJhcXBxWm9uVXhBJm09NyZ0PUFBQUFBRi1aZ3Nn; 47236a0d189c10314faac13e28785259=bcded287772b27ed93b0f868a1c2112d; mbox=PC#13bed9d3bb2045d09a3a04d09dfb9d86.35_0#1667140811|session#2b130163769f496bb9c49df67a16bf01#1603897862; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=4; s_lv=1603896010667; s_getNewRepeat=1603896010669-Repeat; AA_previousCategory=dth%20checkout; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; bm_sv=2881C9ACC42CB051F085EFE2AD0222F3~zfYBPcGgFXyP2f8Cv3uc0sQwJ6foKHqgmglm/5ILd9aYW5mJqhuYamGL438tG2MENEDwTrWfEuZRYXPH/od6nroEibLnQNyDd4ClGQNpzLPj52nGuVO0NzTo6NCTYCwdCVAjoLA4Uo+5DGt1irhR7pxTZhGMHrFmuNDM7T9sGfY=; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; cartId=f95041c8-98d0-4cb3-b554-7ff2b600990a; dtLatC=4; dtPC=1$96007592_194h8vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; rxvt=1603897814184|1603894974879",
            "referer": "https://www.bestbuy.ca/checkout/",
            # "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            "x-dtreferer": "https://www.bestbuy.ca/checkout/#/en-ca/shipping/QC/H3G0E1",
            # "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            # 'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            # 'cookie':'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            'cookie': cookie,
            "x-tx": xtx
        }
        if self.proxyornot:
            r = self.session.put(url,headers=headers,json=data, proxies = self.proxy)
        else:
            r = self.session.put(url,headers=headers,json=data)
        print('############')
        print('submit payment')
        print(r.text)

    def submit_order(self,id,totalPurchasePrice):
        url = "https://www.bestbuy.ca/api/checkout/checkout/orders/submit"
        # headers = {
        #     "accept": "application/vnd.bestbuy.checkout+json",
        #     "accept-encoding": "gzip, deflate, br",
        #     "accept-language": "en-CA",
        #     "content-Length": "5665",
        #     "content-type": "application/json",
        #     "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
        #     "Host": "www.bestbuy.ca",
        #    # "cookie": "cookie: rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={\"currentUrlPath\":\"/en-ca/basket\",\"hasSurveyBeenDisplayed\":false,\"heartBeat\":1586292708,\"isInSampling\":false,\"pageViewCount\":4,\"surveyLastDisplayed\":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJiZTNkNGJlNi05MTlhLTQzYzAtYmQzYy1jMzBlNzcwOWI2NDAifQ.-CZjY90famiPhuWwCaRXE-notOWw6r0ZlG467JKDrmc; 3cb77e1367939b2c1a51f46cb3d4be5b=b29482b9b8508d5b13a1e75da3a0a12a; bm_mi=06E6CA2C944AA5733D908CD6708FAB0B~TYgdNNEKNVz0pmfBajxhnz85D+nGcz1ekJXwpuM+8Wxiz8tqC8GlLYoAChzTQ/nEZ1oAjwg3XdHUHjoHI3QK4CqqRw808XIVEfr5JLvzCqywlkxXjIrGg9xAOGs133/kQRFKmt/URdGIUigRCZp9mSiCmyWR7Bnm3OTMKBoBHqo5ZyboCeHNy/YUegVjcMB3yp0a9lI3U9mzCDoqoUBGIvSY+9+60pClL6FNN8S6/eY=; bm_sv=F6CF3667E0E5AB7AB2F275BC98955B54~UKUpNtMqQhOlBJ7pWmPxrWgFw55SVdv+cOJGFTZFXbPX3vf96jFidYrYxjIqYci9YMVia6As0XIx4qmPzZhljYZ5g64oUFJkN2wGpNefVgpdMTpbJbVObVaBS9PTnvBD29H03WenUjc1+fG2fQ+ExCUcCNm86Erd86MGLj07ZDg=; ak_bmsc=F9C619C16FB4730BCB3470940107336BB896608710130000DBC4985E0088A70E~pl0nPtMNLkqyCxF75i45OJ+EqhxKYCBzVRkH7X9RlM4W4d7wKz9vq1P9bNL0t3hFxDHlxT6UAOnuLT+njUzwe7ku47hT1KFQUB0X2hIRYpCaVzCiEaJfUn4M6ZqttjhIfgxC3ydrB481xlgqAOaVAoK35deBAPjN3ndrMEPoJY2AOBhPU1nyAZ7Om6Q8EiLyBa1qmOqzmaAFyMa4t+UEmLuU2VtLOBNg91cHwkpTLEWy1gp65xJfxlPnTOi8drB8KD",
        #     "referer": "https://www.bestbuy.ca/checkout/",
        #     "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
        #     'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
        # }
        headers = {
            "accept": "application/vnd.bestbuy.checkout+json",
            "accept-encoding": "gzip, deflate, br",
            "accept-language": "en-CA",
            "content-type": "application/json",
            "content-length": "493",
            "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.163 Safari/537.36",
            "Host": "www.bestbuy.ca",
            # "cookie":"clientId=LKW79mCc6IWh15uj; criteoVisitorId=4373ca22-d8b3-47e3-b95d-b4efdab250c0; s_ecid=MCMID%7C53412406115792407981988834282011167775; ai_user=uT/Y1|2020-09-26T22:45:19.755Z; gbi_visitorId=ckfk9iise00013b7zja1w2wem; BVBRANDID=d43954e6-773b-4a20-949b-f535ebc0fd37; _gcl_au=1.1.2052194769.1601160325; _ga=GA1.2.1267216390.1601160320; _pin_unauth=dWlkPU56SmpNVFppWWpZdE9XVTFNQzAwT0dReUxUbG1ZV1F0TWpZNE5tRmpaRGczTWpSbA; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; _gcl_dc=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gcl_aw=GCL.1603645937.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; _gac_UA-122294325-1=1.1603645941.Cj0KCQjwxNT8BRD9ARIsAJ8S5xa6-3EE7PabN3Rbyv6e9SyQbvceyfbHX2nYBmuGb3h6ecUI_bgLR9waAiO9EALw_wcB; s_ev46=%5B%5B%27knc-s-71700000055465044%27%2C%271601160324957%27%5D%2C%5B%27knc-s-71700000071852306%27%2C%271601519284827%27%5D%2C%5B%27knc-s-71700000065731896%27%2C%271601519312498%27%5D%2C%5B%27knc-s-71700000072655674%27%2C%271603645941045%27%5D%5D; s_cc=true; check=true; bm_mi=C956D62C091E3B40E4B5927D3A8DD920~JPJusPStPfy5PCCzkfSsDfJTuY1ZQD2CYfeGGfMfa6dzkm2d2/OKq3shWK0EO/lrSKz7kfz9oDrk6F9u4q5c6MPwiq/UPUCoatMpaOvmKUQ8xX9pyt1yovrVnzcNoLcwBeK7uGOSG8XzTvQHIDzfrinCpbyLYY8v2HZlTPv25/3KGLJi/MrWSubrd8XLi8+5k9jonRxk5j2nFsh5yMiUPQV+tgG1U/AlD7dhAcobUGN5X4O0xXGM1DniFGxLqNUvLqFVaiu/e6pbTHZjMe08lA==; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18564%7CMCMID%7C53412406115792407981988834282011167775%7CMCAAMLH-1604493789%7C7%7CMCAAMB-1604493789%7CRKhpRz8krg2tLO6pguXWp5olkAcUniQYPHaMWWgdJ3xzPWQmdj0y%7CMCOPTOUT-1603896189s%7CNONE%7CMCAID%7CNONE%7CvVersion%7C3.3.0; ak_bmsc=F34B7C2D9E147F098073E80747FC6015B8966096790B00005D67995FFBB0C02E~plMBCWiDzGCSS47CMkDeDnpY67JcTD2GF0LJlEZHeiTSBABsFHo3L72946pZ3tRj9V/lxuPW++si4jUwfdGXGL/NYTcsa9lEhjLlCCd1bxH0AxYOrHxadHxFgOGL3FgAU9j24t3Zt6OuNLTaPPS0UxF5TMwQWOImql1gwHsf+5VtHdh3G2+HH9LbDn+QwH/jmKurqM3D8HN5AZY1VXEhiEu+f+oL2ers7xddlG7FQ4cEM9PWjDnxyx5JQpIxNNxeYs; _gid=GA1.2.976140257.1603888991; BVImplmain_site=18193; dtm_mSession=2b130163769f496bb9c49df67a16bf01; _gat_gtag_UA_122294325_1=1; gbi_sessionId=ckgti9g1800013b85xace2yjy; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Qu%c3%a9bec%22%2c%22postalCode%22%3a%22G1H%22%2c%22region%22%3a%22QC%22%7d%7d; dtLatC=1; s_lv_s=Less%20than%201%20day; s_vnum=1604203200574%26vn%3D6; s_invisit=true; AA_previousTA=; nps={'currentUrlPath':'/en-ca/basket','hasSurveyBeenDisplayed':false,'heartBeat':'1603896001','isInSampling':false,'pageViewCount':4,'surveyLastDisplayed':1632696319}; dtPC=1$93165733_79h-vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiIwNGU4MzE0MS01MjJlLTQ2NjUtYTMwNS0zNGM3MzBjYTcwZjAifQ.Iz0mUoe9n4hLz3EFYJPQ1BghcSjyX8sHuRRZ2Al7-z0; fdb7491a5cc3d693edd0926b3a48659f=4e9d755d4d178d67f3fc84c07bfb8d97; rxvt=1603897803305|1603894974879; AA_previousPageType=; s_sq=%5B%5BB%5D%5D; ai_session=iC0k5E2oH0EM1bwdu4DUwA|1603895992147|1603896007100.675; rxVisitor=1603645933792B0H5M61G6JUA2LPQLB62U14BTS40NNM0; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1603896003043%7C93165733_79%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1603893172502%7C%7C; b6bab32db12a74433294191e1fddb23a=33757115b51b0d3d8d213f0b5d5a4387; _derived_epik=dj0yJnU9b2VzdVo1NXBMdzVfRlBJVmRCN3dNekZNOGtKU092UDYmbj1LVnV6NHZHZnlZQnJhcXBxWm9uVXhBJm09NyZ0PUFBQUFBRi1aZ3Nn; 47236a0d189c10314faac13e28785259=bcded287772b27ed93b0f868a1c2112d; mbox=PC#13bed9d3bb2045d09a3a04d09dfb9d86.35_0#1667140811|session#2b130163769f496bb9c49df67a16bf01#1603897862; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=4; s_lv=1603896010667; s_getNewRepeat=1603896010669-Repeat; AA_previousCategory=dth%20checkout; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; bm_sv=2881C9ACC42CB051F085EFE2AD0222F3~zfYBPcGgFXyP2f8Cv3uc0sQwJ6foKHqgmglm/5ILd9aYW5mJqhuYamGL438tG2MENEDwTrWfEuZRYXPH/od6nroEibLnQNyDd4ClGQNpzLPj52nGuVO0NzTo6NCTYCwdCVAjoLA4Uo+5DGt1irhR7pxTZhGMHrFmuNDM7T9sGfY=; dtCookie=1$5MBEO19773S1N4CRTJC8D170A3EUDVHE|ea7c4b59f27d43eb|0; cartId=f95041c8-98d0-4cb3-b554-7ff2b600990a; dtLatC=4; dtPC=1$96007592_194h8vNHLRABFJMMOKLWTJILRPTKEIVNHUJVRN-0e2; rxvt=1603897814184|1603894974879",
            "referer": "https://www.bestbuy.ca/checkout/",
            # "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            "x-dtreferer": "https://www.bestbuy.ca/checkout/#/en-ca/shipping/QC/H3G0E1",
            # "x-tx": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo",
            # 'cookie': 'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            # 'cookie':'rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; AMCVS_D6E638125859683E0A495D2D%40AdobeOrg=1; s_ecid=MCMID%7C86301909305537420292522418325688314886; clientId=nSWenUUFu9LCsF7h; criteoVisitorId=6d567f78-647d-454f-8c1c-5f69440224e8; enabled=1; ReturnUrl=https://www.bestbuy.ca/; surveyOptOut=1; ai_user=FyuDQ|2020-04-07T18:42:14.442Z; BVBRANDID=e708a65e-4651-4c13-b8f9-643934cbd3d6; _fbp=fb.1.1586284937175.1490006803; s_cc=true; check=true; aam_uuid=86071685624051341682573588122486112659; _gcl_au=1.1.50370926.1586284938; _ga=GA1.2.1778786793.1586284934; _gid=GA1.2.59619382.1586284938; BVImplmain_site=18193; __gads=ID=48c7ba964919b01b:T=1586284933:S=ALNI_MaEWqkaMCXajItYR_MdCK2FV8O0Fg; CS_Culture=en-CA; lastUsedLocations=%7b%22shippingLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%2c%22pickupLocation%22%3a%7b%22city%22%3a%22Montr%c3%a9al%22%2c%22postalCode%22%3a%22H3K%22%2c%22region%22%3a%22QC%22%7d%7d; tx=eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiI0NjZmNDlmNy01MmNhLTQ5YmQtYTZjZi0wMTA4NzU1MDNlMTUifQ.CsMAVW85JR97WyRgeNLx9nME0cgYIwaLL1n5DvjGepo; fdb7491a5cc3d693edd0926b3a48659f=5d1f449fef6e21babd7e36c3b0a1df14; rxVisitor=1586284932701BKU14G3B9REQKSF1GGC2IBES92PHH1KH; b6bab32db12a74433294191e1fddb23a=59f47724f688c74e7ad84e8220bf16f4; 3cb77e1367939b2c1a51f46cb3d4be5b=b4bb7e6220cccbdd59ecd36800d39361; dtm_mSession=0b341067d3f94f37ac1bc5e0c28413f0; s_lv_s=Less%20than%201%20day; s_vnum=1588305600678%26vn%3D3; s_invisit=true; AA_previousTA=; QueueITAccepted-SDFrts345E-V3_20191224xmas=EventId%3D20191224xmas%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292459%26Hash%3Db6e9b9e832c117fa3570f2dac9b546a847a22022d4cbc117a38a9199c733feef; AMCV_D6E638125859683E0A495D2D%40AdobeOrg=-1303530583%7CMCIDTS%7C18360%7CMCMID%7C86301909305537420292522418325688314886%7CMCAAMLH-1586897260%7C7%7CMCAAMB-1586897260%7C6G1ynYcLPuiQxYZrsz_pkqfLG9yMXBpb2zX5dvJdYQJzPXImdj0y%7CMCOPTOUT-1586299660s%7CNONE%7CMCAID%7CNONE%7CMCSYNCSOP%7C411-18367%7CvVersion%7C3.3.0; BVBRANDSID=0cae47d0-133f-4c52-bd47-723e07c43e12; nps={"currentUrlPath":"/en-ca/basket","hasSurveyBeenDisplayed":false,"heartBeat":1586292708,"isInSampling":false,"pageViewCount":4,"surveyLastDisplayed":1617820934}; _gat_gtag_UA_122294325_1=1; dtSa=true%7CC%7C-1%7CContinue%20to%20Checkout%7C-%7C1586292718498%7C492611326_438%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fen-ca%2Fbasket%7CYour%20Cart%20-%20Best%20Buy%20Canada%20%5Ep%20Best%20Buy%20Canada%7C1586292618939%7C; s_sq=%5B%5BB%5D%5D; dtSa=true%7CC%7C-1%7CCart%7C-%7C1586291493912%7C489427974_154%7Chttps%3A%2F%2Fwww.bestbuy.ca%2Fcheckout%2F%3Fqit%3D1%7CSecure%20Checkout%20-%20Best%20Buy%20Canada%7C1586289433043%7C%2Fen-ca%2Fpayment; dtLatC=3; QueueITAccepted-SDFrts345E-V3_mth2019boxingday=EventId%3Dmth2019boxingday%26QueueId%3D00000000-0000-0000-0000-000000000000%26RedirectType%3Dafterevent%26IssueTime%3D1586292721%26Hash%3Dd5d9f2db51f6a2ec079f9f8241726b355ee32629dca626465098db0bc95a26e8; dtPC=1$492721585_165h-vENMPMLRFSXJOROTMKPIFGSRUPKTMLSGQ; mbox=PC#b0f75415079048518a51085098d36e59.28_0#1649537525|session#0b341067d3f94f37ac1bc5e0c28413f0#1586293356; AA_hasSeenCheckoutThisVisit=true; AA_pagePathingCount=8; s_lv=1586292724765; s_getNewRepeat=1586292724769-Repeat; AA_previousPageName=checkout%20|dth%20checkout%20|shipping; AA_previousCategory=dth%20checkout; AA_previousPageType=checkout; ai_session=xTxVo|1586291497169|1586292724974.945; dtCookie=1$58LAFJH1KKEOAGN4DEI42QMHN2J9KV4A|ea7c4b59f27d43eb|1; rxvt=1586294526700|1586291414500; cartId=4b80e997-f8c8-4b34-b34f-de7181c9905f'
            'cookie': cookie,
            "x-tx": xtx
        }
        data = {"cvv":"187","email":"lzweijinwei196@gmail.com","secureAuthenticationResponse":"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"}
        data["totalPurchasePrice"] = totalPurchasePrice
        data["id"] = id
        if self.proxyornot:
            r = self.session.post(url, headers=headers, json=data, proxies=self.proxy)
        else:
            r = self.session.post(url, headers=headers,json=data)
        order_detail = json.loads(r.text)
        print("#################")
        print('submit order')
        print(order_detail)
        if order_detail['orderNumber'] != 'null' and order_detail['orderNumber'] != None:
            print('order ' + order_detail['orderNumber'] + " Successfully placed")
            return True
        else:
            print('order failed, retrying')
            return False

proxies = load_proxy('proxy.text')
while True:
    the_proxy = parse_proxy(random.choice(proxies))
    try:
        #When creating the bestbuy obj, its default to use proxy and only checkout once, u can pass in different params.
        bestbuy = bestbuy(the_proxy)
    except Exception as e:
        pass
